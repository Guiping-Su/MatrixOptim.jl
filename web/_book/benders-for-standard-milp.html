<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Benders for Standard MILP | MatrixOptim</title>
  <meta name="description" content="Data-Driven Decision Making under Uncertainty in Matrix." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Benders for Standard MILP | MatrixOptim" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Data-Driven Decision Making under Uncertainty in Matrix." />
  <meta name="github-repo" content="edxu96/MatrixOptim.jl" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Benders for Standard MILP | MatrixOptim" />
  
  <meta name="twitter:description" content="Data-Driven Decision Making under Uncertainty in Matrix." />
  

<meta name="author" content="Edward J. Xu" />


<meta name="date" content="2020-05-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="De.html"/>
<link rel="next" href="De-benders-l.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MatrixOptim</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="part"><span><b>I Algorithms</b></span></li>
<li class="chapter" data-level="1" data-path="linear-programming-lp.html"><a href="linear-programming-lp.html"><i class="fa fa-check"></i><b>1</b> Linear Programming (LP)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simplex-method.html"><a href="simplex-method.html"><i class="fa fa-check"></i><b>1.1</b> Simplex Method</a></li>
<li class="chapter" data-level="1.2" data-path="duality-theory.html"><a href="duality-theory.html"><i class="fa fa-check"></i><b>1.2</b> Duality Theory</a></li>
<li class="chapter" data-level="1.3" data-path="LP-Sense.html"><a href="LP-Sense.html"><i class="fa fa-check"></i><b>1.3</b> Sensitivity Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="MILP.html"><a href="MILP.html"><i class="fa fa-check"></i><b>2</b> Mixed Integer Linear Programming</a></li>
<li class="chapter" data-level="3" data-path="De.html"><a href="De.html"><i class="fa fa-check"></i><b>3</b> Decomposition Algorithms</a>
<ul>
<li class="chapter" data-level="3.1" data-path="benders-for-standard-milp.html"><a href="benders-for-standard-milp.html"><i class="fa fa-check"></i><b>3.1</b> Benders for Standard MILP</a></li>
<li class="chapter" data-level="3.2" data-path="De-benders-l.html"><a href="De-benders-l.html"><i class="fa fa-check"></i><b>3.2</b> L-Benders for Sto-Prog</a></li>
<li class="chapter" data-level="3.3" data-path="De-benders-l-int.html"><a href="De-benders-l-int.html"><i class="fa fa-check"></i><b>3.3</b> L-Benders with Second Stage Int-Var</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="network-optimization.html"><a href="network-optimization.html"><i class="fa fa-check"></i><b>4</b> Network Optimization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="MCF.html"><a href="MCF.html"><i class="fa fa-check"></i><b>4.1</b> Minimum Cost Flow (MCF)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="non-linear-programming-nlp.html"><a href="non-linear-programming-nlp.html"><i class="fa fa-check"></i><b>5</b> Non-Linear Programming (NLP)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="classical-methods-of-calculus.html"><a href="classical-methods-of-calculus.html"><i class="fa fa-check"></i><b>5.1</b> Classical Methods of Calculus</a></li>
<li class="chapter" data-level="5.2" data-path="kkt-conditions.html"><a href="kkt-conditions.html"><i class="fa fa-check"></i><b>5.2</b> KKT Conditions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Decen.html"><a href="Decen.html"><i class="fa fa-check"></i><b>6</b> Decentralized Optimization</a></li>
<li class="chapter" data-level="7" data-path="relaxation-approximation.html"><a href="relaxation-approximation.html"><i class="fa fa-check"></i><b>7</b> Relaxation (Approximation)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="of-integer-programming.html"><a href="of-integer-programming.html"><i class="fa fa-check"></i><b>7.1</b> of Integer Programming</a></li>
<li class="chapter" data-level="7.2" data-path="lagrangian-relaxation.html"><a href="lagrangian-relaxation.html"><i class="fa fa-check"></i><b>7.2</b> Lagrangian Relaxation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="heuristics.html"><a href="heuristics.html"><i class="fa fa-check"></i><b>8</b> Heuristics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bayesian-optimization.html"><a href="bayesian-optimization.html"><i class="fa fa-check"></i><b>8.1</b> Bayesian Optimization</a></li>
</ul></li>
<li class="part"><span><b>II Operations Research</b></span></li>
<li class="chapter" data-level="9" data-path="decision-making-under-uncertainty.html"><a href="decision-making-under-uncertainty.html"><i class="fa fa-check"></i><b>9</b> Decision Making under Uncertainty</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bayesian-decision-analysis.html"><a href="bayesian-decision-analysis.html"><i class="fa fa-check"></i><b>9.1</b> Bayesian Decision Analysis</a></li>
<li class="chapter" data-level="9.2" data-path="stochastic-programming.html"><a href="stochastic-programming.html"><i class="fa fa-check"></i><b>9.2</b> Stochastic Programming</a></li>
<li class="chapter" data-level="9.3" data-path="robust-programming.html"><a href="robust-programming.html"><i class="fa fa-check"></i><b>9.3</b> Robust Programming</a></li>
<li class="chapter" data-level="9.4" data-path="newsvendor-problem.html"><a href="newsvendor-problem.html"><i class="fa fa-check"></i><b>9.4</b> Newsvendor Problem</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="game-theory.html"><a href="game-theory.html"><i class="fa fa-check"></i><b>10</b> Game Theory</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mechanism-design.html"><a href="mechanism-design.html"><i class="fa fa-check"></i><b>10.1</b> Mechanism Design</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="MDP.html"><a href="MDP.html"><i class="fa fa-check"></i><b>11</b> Markov Decision Process (MDP)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="markov-chain.html"><a href="markov-chain.html"><i class="fa fa-check"></i><b>11.1</b> Markov Chain</a></li>
<li class="chapter" data-level="11.2" data-path="queueing-theory.html"><a href="queueing-theory.html"><i class="fa fa-check"></i><b>11.2</b> Queueing Theory</a></li>
<li class="chapter" data-level="11.3" data-path="inventory-management.html"><a href="inventory-management.html"><i class="fa fa-check"></i><b>11.3</b> Inventory Management</a></li>
</ul></li>
<li class="part"><span><b>III Application</b></span></li>
<li class="chapter" data-level="12" data-path="double-auction.html"><a href="double-auction.html"><i class="fa fa-check"></i><b>12</b> Double Auction</a>
<ul>
<li class="chapter" data-level="12.1" data-path="DA-P.html"><a href="DA-P.html"><i class="fa fa-check"></i><b>12.1</b> Periodic DA (PDA)</a></li>
<li class="chapter" data-level="12.2" data-path="DA-C.html"><a href="DA-C.html"><i class="fa fa-check"></i><b>12.2</b> Continuous DA (CDA)</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="PSB.html"><a href="PSB.html"><i class="fa fa-check"></i><b>13</b> Power System Balancing (PSB)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="UC.html"><a href="UC.html"><i class="fa fa-check"></i><b>13.1</b> Unit Commitment (UC)</a></li>
<li class="chapter" data-level="13.2" data-path="UCC.html"><a href="UCC.html"><i class="fa fa-check"></i><b>13.2</b> Construction &amp; UC (UCC)</a></li>
<li class="chapter" data-level="13.3" data-path="transmission-network.html"><a href="transmission-network.html"><i class="fa fa-check"></i><b>13.3</b> Transmission Network</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="MPC.html"><a href="MPC.html"><i class="fa fa-check"></i><b>14</b> Model Predictive Control (MPC)</a></li>
<li class="chapter" data-level="15" data-path="RM.html"><a href="RM.html"><i class="fa fa-check"></i><b>15</b> Revenue Management (RM)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="dynamic-pricing.html"><a href="dynamic-pricing.html"><i class="fa fa-check"></i><b>15.1</b> Dynamic Pricing</a></li>
<li class="chapter" data-level="15.2" data-path="scalper.html"><a href="scalper.html"><i class="fa fa-check"></i><b>15.2</b> Scalper</a></li>
<li class="chapter" data-level="15.3" data-path="with-strategic-customers.html"><a href="with-strategic-customers.html"><i class="fa fa-check"></i><b>15.3</b> with Strategic Customers</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="MAS.html"><a href="MAS.html"><i class="fa fa-check"></i><b>16</b> Multi-Agent System (MAS)</a>
<ul>
<li class="chapter" data-level="16.1" data-path="MAS-Co.html"><a href="MAS-Co.html"><i class="fa fa-check"></i><b>16.1</b> Cooperative MAS</a></li>
<li class="chapter" data-level="16.2" data-path="MAS-Nonco.html"><a href="MAS-Nonco.html"><i class="fa fa-check"></i><b>16.2</b> Noncooperative MAS</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="intermediation.html"><a href="intermediation.html"><i class="fa fa-check"></i><b>17</b> Intermediation</a>
<ul>
<li class="chapter" data-level="17.1" data-path="VPP.html"><a href="VPP.html"><i class="fa fa-check"></i><b>17.1</b> Virtual Power Plant (VPP)</a></li>
<li class="chapter" data-level="17.2" data-path="dynamic-procurement-pricing-dpp.html"><a href="dynamic-procurement-pricing-dpp.html"><i class="fa fa-check"></i><b>17.2</b> Dynamic Procurement &amp; Pricing (DPP)</a></li>
<li class="chapter" data-level="17.3" data-path="principal-agent-problem-pa.html"><a href="principal-agent-problem-pa.html"><i class="fa fa-check"></i><b>17.3</b> Principal-Agent Problem (PA)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="linear-algebra.html"><a href="linear-algebra.html"><i class="fa fa-check"></i><b>A</b> Linear Algebra</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MatrixOptim</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="benders-for-standard-milp" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Benders for Standard MILP</h2>
<p>According to wikipedia:</p>
<blockquote>
<p>Benders decomposition (or Benders’ decomposition) is a technique in mathematical programming that allows the solution of very large linear programming problems that have a special block structure. This block structure often occurs in applications such as stochastic programming as the uncertainty is usually represented with scenarios. The technique is named after Jacques F. Benders.</p>
</blockquote>
<p>For standard MILP, get rid of <span class="math inline">\(\mathbf{x}\)</span>, we get:</p>
<p><span class="math display">\[ \begin{align}
\min \quad &amp; \mathbf{f} ^ { T } \mathbf{y} + g ( y ) \\
\text{s.t.} \quad&amp; \mathbf{y} \in Y
\end{align} \]</span></p>
<p>and</p>
<p><span class="math display">\[ \begin{align}
g(y) = \min \quad&amp; \mathbf{c}^{T} \mathbf{x} \\
\text{s.t.} \quad&amp; \mathbf{A} \mathbf{x} \geq \mathbf{b} - \mathbf{B} \overline{\mathbf{y}} \\
&amp; \mathbf{x} \geq 0
\end{align} \]</span></p>
<p>The dual function of <span class="math inline">\(g(y)\)</span>:</p>
<p><span class="math display">\[ \begin{align}
g_d(y) = \max \quad &amp; (\mathbf{b} - \mathbf{B}\overline{\mathbf{y}})^{T} \mathbf{u} \\
\text{s.t.} \quad&amp; \mathbf{A}^{T} \mathbf{u} \leq \mathbf{c} \\
&amp; \mathbf{u} \geq 0
\end{align} \]</span></p>
<p>where the constraints of the dual <span class="math inline">\(g(y)\)</span> does not contain any <span class="math inline">\(\mathbf{y}\)</span> values. Hence we can now analyze the feasibility of the model without considering the value of <span class="math inline">\(\mathbf{y}\)</span>.</p>
<p>Given the Minkovsky Fication theorem, we can hence reformulate the dual <span class="math inline">\(g(y)\)</span> LP program as extreme points <span class="math inline">\(u^p\)</span> and extreme rays <span class="math inline">\(u^r\)</span>. Assume that we enumerate all the extreme points and extreme rays, we can reformulate:
<span class="math display">\[ \begin{align}
u &amp; = \sum _ { i } \lambda _ { i } ^ { p } \cdot u _ { i } ^ { P } + \sum _ { j } \lambda _ { j } ^ { r } \cdot u _ { j } ^ { r } \\
\sum _ { i } \lambda _ { i } ^ { p } &amp;= 1 \\
\lambda _ { i } ^ { p } , \lambda _ { j } ^ { r } &amp; \geq 0
\end{align} \]</span></p>
<p><span class="math inline">\(g_d(y)\)</span> can be expressed to:
<span class="math display">\[ \begin{align}
g_{\text{dual}}(y) = \max \quad&amp; (\mathbf{b} - \mathbf{B}\overline{\mathbf{y}})^{T} \mathbf{u} \\
\text{s.t.} \quad&amp; u = \sum _ { i } \lambda _ { i } ^ { p } \cdot u _ { i } ^ { p } + \sum _ { j } \lambda _ { j } ^ { r } \cdot u _ { j } ^ { r } \\
&amp; \sum _ { i } \lambda _ { i } ^ { p } = 1 \\
&amp; \lambda _ { i } ^ { p } , \lambda _ { j } ^ { r } \geq 0 \\
&amp; \mathbf{u} \geq 0
\end{align} \]</span></p>
<p>Substitute the <span class="math inline">\(u\)</span> variables with the extreme points and extreme rays (and multiply <span class="math inline">\((b − By)\)</span> into the sum’s):
<span class="math display">\[ \begin{align}
g_{\text{dual}}(y) = \max \quad&amp; ( b - B \overline { y } ) ^ { T } \times \sum _ { i } \lambda _ { i } ^ { p } \cdot u _ { i } ^ { p } + ( b - B \overline { y } ) ^ { T } \times \sum _ { j } \lambda _ { j } ^ { r } \cdot u _ { j } ^ { r } \\
\text{s.t.} \quad&amp; \sum _ { i } \lambda _ { i } ^ { p } = 1 \\
&amp; \lambda _ { i } ^ { p } , \lambda _ { j } ^ { r } \geq 0
\end{align} \]</span></p>
<p>If we select a <span class="math inline">\(y\)</span> such that just one term <span class="math inline">\((b - B\overline{y})^T u_j^r\)</span> becomes positive, i.e. <span class="math inline">\((b - B\overline{y})^T u_j^r &gt; 0\)</span> then the LP is unbounded because there are no limits on the <span class="math inline">\(\lambda_j^r\)</span>. Hence in order not to get an unbounded dual <span class="math inline">\(g(y)\)</span> function corresponding to not getting an infeasible <span class="math inline">\(g(y)\)</span> we have to ensure that this does not happen for any extreme ray.</p>
<p>If an optimal solution exists (i.e. the polyhedron is not un-bounded or infeasible), at least one optimal solution to the dual <span class="math inline">\(g(y)\)</span> function is a corner point <span class="math inline">\(u_i^p\)</span>. Hence the dual <span class="math inline">\(g(y)\)</span> function has the value of the maximal point. We need to find the corner point</p>
<p>Let’s ensure feasibility and add the value of the maximal point:
<span class="math display">\[ \begin{align}
\min \quad&amp; q \\
\text{s.t.} \quad&amp; \overline { u _ { j } ^ { r } } \cdot ( b - B y ) \leq 0 \quad \forall j \\
&amp; \overline { u _ { i } ^ { p } } \cdot ( b - B y ) \leq q \quad \forall i \\
&amp; y \in Y , q \in R
\end{align} \]</span></p>
<p>The above problem becomes the so-called <strong>Benders Master Problem (BMP)</strong>:
<span class="math display">\[ \begin{align}
\min \quad&amp; \mathbf{f}^{T} \mathbf{y} + q \\
\text{s.t.} \quad&amp; \mathbf{\overline {u_{j}^{r}}} (\mathbf{b} - \mathbf{B} \mathbf{y} ) \leq 0 \quad \forall j \\
&amp; \mathbf{\overline {u_{i}^{p}}} (\mathbf{b} - \mathbf{B} \mathbf{y} ) \leq q \quad \forall i \\
&amp; y \in Y \\
&amp; q \in R
\end{align} \]</span></p>
<div id="cutting-planes" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Cutting Planes</h3>
<p>We can consider the Bender’s algorithm as a cutting plane algorithm: We know there is an exponential amount of cuts, but we only generate them when needed … by solving the Benders Sub Problem (BSP):
<span class="math display">\[ \begin{align}
\max \quad&amp; (\mathbf{b} - \mathbf{B} \mathbf{\overline{y}})^{T} \mathbf{u} \\
\text{s.t.} \quad&amp; \mathbf{A}^{T} \mathbf{u} \leq \mathbf{c} \\
&amp; \mathbf{u} \geq \mathbf{0}
\end{align} \]</span>
We use the BSP problem to find the extreme points <span class="math inline">\(\overline{u_i^p}\)</span>. These we use to generate the so-called optimality cuts.</p>
<p>To generate the so-called feasibility cuts, we need to be able to find extreme rays, i.e. if the BSP is un-bounded when we try to solve it, we need to find one extreme ray of that problem. This we will deal with next week. For now (in the exercises) we will assume that the BSP is NOT un-bounded.</p>
</div>
<div id="benders-algorithm" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Benders Algorithm</h3>
<p>Write up the MASTER-PROBLEM, without any constraints:
<span class="math display">\[ \begin{align}
\min \quad&amp; z_{MAS} = q + f ^ { T } y \\
\text{s.t.} \quad&amp; y \in Y \\
&amp; q , z_{MAS} \in R
\end{align} \]</span>
Actually, if there are constraints in the original problem with only <span class="math inline">\(y\)</span> variables, then these constraints can and should stay.</p>
<p>Assume the <span class="math inline">\(y\)</span> variables are fixed. Move the (now) <span class="math inline">\(y\)</span> constants to the right hand side and dualize the problem. This is the SUB-PROBLEM:
<span class="math display">\[ \begin{align}
\max \quad &amp; z_{SUB} = ( b - B \overline { y } ) ^ { T } u \\
\text{s.t.} \quad &amp; A ^ { T } u \leq c \\
&amp; u \geq 0 \\
&amp; z_{SUB} \in R
\end{align} \]</span></p>
<p>The BSP is the dual of the following model:
<span class="math display">\[ \begin{align}
\min \quad&amp; c^T x \\
\text{s.t.} \quad&amp; A x \geq b - B \overline{y} \\
&amp; x \geq 0
\end{align} \]</span>
But this model is the original problem and if we add <span class="math inline">\(f^T \overline{y}\)</span> to the value, then it is a feasible solution to the original problem, hence a legal upper bound.</p>
<p>The <span class="math inline">\(z_{LOW}\)</span> bound is the optimal value of the BMP:
<span class="math display">\[ \begin{align}
\min \quad&amp; z_{LOW} = z_{MAS} = q + f ^ { T } y \\
\quad&amp; \overline { u _ { j } ^ { r } } \cdot ( b - B y ) \leq 0 \quad \forall j \\
&amp; \overline { u _ { i } ^ { p } } \cdot ( b - B y ) \leq q \quad \forall i \\
&amp; y \in Y , q \in R
\end{align} \]</span>
Notice that during the Benders algorithm the relaxed problem is solved (not all constraints are there). Hence a feasible lower bound.</p>
<p>If the Benders sub-problem is un-bounded, then the original problem, changed by the chosen y variables, is in-feasible. Hence we add a constraint to the Benders master problem, the feasibility constraint, which makes such a choice of y variable values impossible.</p>
<p>To find the extreme rays, we first insert 0 on the right-hand side.</p>
<p>Benders’ Sub Problem</p>
<p><span class="math display">\[ \begin{align}
g_d(y) = \max \quad&amp; (\mathbf{b} - \mathbf{B}\overline{\mathbf{y}})^{T} \mathbf{u} \\
\text{s.t.} \quad&amp; \mathbf{A}^{T} \mathbf{u} \leq \mathbf{c} \\
&amp; \mathbf{u} \geq 0
\end{align} \]</span></p>
<p>Then, we set dummy:</p>
<p><span class="math display">\[ \begin{align}
g_d(y) = \max \quad &amp; dummy \\
\text{s.t.} \quad &amp; dummy = 1 \\
&amp;  (\mathbf{b} - \mathbf{B}\overline{\mathbf{y}})^{T} \mathbf{u}  = 1\\
&amp; \mathbf{A}^{T} \mathbf{u} \leq 0 \\
&amp; \mathbf{u} \geq 0
\end{align} \]</span></p>
</div>
<div id="simple-illustration" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Simple Illustration</h3>
<p><span class="math display">\[ \begin{align}
\min \quad&amp; z_0 = 5 x - 3 y \\
\text{s.t.} \quad&amp; x + 2 y \geq 4 \\
&amp; 2 x - y \geq 0 \\
&amp; x - 3 y \geq - 13 \\
&amp; x \geq 0 \\
&amp; y \in \{ 0,1 , \ldots , 10 \}
\end{align} \]</span></p>
<p>In standard form:</p>
<p><span class="math display">\[ \begin{align}
\min \quad&amp; \mathbf{c}^{T} \mathbf{x} + \mathbf{f} ^ { T } \mathbf{y} \\
\text{s.t.} \quad&amp; \mathbf{A} \mathbf{x} + \mathbf{B} \mathbf{y} \geq \mathbf{b}  \\
&amp; \mathbf{y} \in Y \\
&amp; \mathbf{x} \geq 0
\end{align} \]</span></p>
<p>where</p>
<p><span class="math display">\[ \begin{align}
\mathbf{c} &amp;= (5)^T \\
\mathbf{f} &amp;= (-3)^T \\
\mathbf{b} &amp;= (4, 0, -13)^T \\
\mathbf{x} &amp;= (x)^T \\
\mathbf{y} &amp;= (y)^T \\
\mathbf{A} &amp;= \left(\begin{array}{c}
1 \\
2 \\
1
\end{array} \right) \\
\mathbf{B} &amp;= \left(\begin{array}{c}
2 \\
-1 \\
-3
\end{array} \right)
\end{align} \]</span></p>
<p>Move the <span class="math inline">\(y\)</span> constants to the right hand side of the constraints.
<span class="math display">\[ \begin{align}
\min \quad &amp; 5 x - 3 \overline{y} \\
\text{s.t.} \quad &amp; x \geq 4 - 2 \overline{y} \\
&amp; 2 x \geq \overline{y} \\
&amp; x \geq 3 \overline{y} - 13 \\
&amp; x \geq 0
\end{align} \]</span></p>
<p>Dualize the model (we need to find the u values, keeping the <span class="math inline">\(y\)</span> constants in the in the objective. This is the Benders Sub Problem:
<span class="math display">\[ \begin{align}
OBJ_{SUB} = \max \quad&amp; (4 - 2 \overline{y}) u_1 + \overline{y} u_2 + (3 \overline{y} - 13) u_3 \\
\text{s.t.} \quad&amp; u_1 + 2 u_2 + u_3 \leq 5 \\
&amp; u_1, u_2, u_3 \geq 0
\end{align} \]</span></p>
<p><span class="math display">\[ \begin{align}
UB = \min \left(OBJ_{SUB} - 3 \overline{y}, UB \right)
\end{align} \]</span></p>
<p><span class="math display">\[ \begin{align}
OBJ_{MAS} = \min \quad&amp; - 3 y + q \\
\text{s.t.} \quad&amp; (4 - 2 y) \overline{u_1} + y \overline{u_2} + (3 y - 13) \overline{u_3} \leq q \quad \forall p \\
&amp; y \in T \\
&amp; q \in R
\end{align} \]</span></p>
<p><span class="math display">\[ \begin{align}
LB = \max(OBJ_{MAS}, LB)
\end{align} \]</span></p>
<p>Now we are ready to execute the algorithm:</p>
<ul>
<li>Assign initial bounds <span class="math inline">\(UB = +\infty\)</span>, <span class="math inline">\(LB = -\infty\)</span> and <span class="math inline">\(\epsilon = a\)</span> small number</li>
<li>Assign inital <span class="math inline">\(\overline{y}\)</span> value (possibly randomly)</li>
<li>Set in the fixed <span class="math inline">\(\overline{y}\)</span> into the Benders sub-problem and solve the Benders sub-problem to get the extreme point <span class="math inline">\(\overline{u}\)</span> and <span class="math inline">\(OBJ_{SUB}\)</span>.</li>
<li>Calculate the upper-bound: <span class="math inline">\(UB = \min \left(OBJ_{SUB} - 3 \overline{y}\right)\)</span></li>
<li>Add new constraint <span class="math inline">\(\sum _ { i } \left( b _ { i } - \sum _ { k } B _ { k } ^ { i } \cdot y _ { k } \right) \overline { u _ { i } } \leq q\)</span> to the Benders master-problem.</li>
<li>Solve the Benders master-problem to get new y values.</li>
<li>Calculate the lower-bound: <span class="math inline">\(LB = OBJ_{MAS}\)</span>.</li>
<li>Terminate if <span class="math inline">\(U B - L B \leq \epsilon\)</span></li>
<li>Go to 3 (with the new value for <span class="math inline">\(y\)</span>)</li>
</ul>
</div>
<div id="simple-illustration-2" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Simple Illustration 2</h3>
<p><span class="math display">\[ \begin{align}
\min \quad &amp; 5 x_1 + 3 x_2 - 3 y_1 + y_2 \\
\text{s.t.} \quad &amp; x_1 + 3 x_2 + 2 y_1 - 4 y_2 \geq 4 \\
&amp; 2 x_1 + x_2 - y_1 + 2 y_2 \geq 0 \\
&amp; x_1 - 5 x_2 - 3 y_1 + y_2 \geq-13 \\
&amp; x_1, x_2  \geq 0 \\
&amp; y_1, y_2 \in \{0, 1, 2, ..., 10 \}
\end{align} \]</span></p>
<p>which can be transformed into standard form:</p>
<p><span class="math display">\[ \begin{align}
\mathbf{c} &amp;= (5, 3)^T \\
  \mathbf{f} &amp;= (-3, 1)^T \\
  \mathbf{b} &amp;= (4, 0, -13)^T \\
  \mathbf{x} &amp;= (x_1, x_2)^T \\
  \mathbf{y} &amp;= (y_1, y_2)^T \\
  \mathbf{A} &amp;= \left(\begin{array}{c}
    1 &amp; 3\\
      2 &amp; 1 \\
      1 &amp; -5
  \end{array} \right) \\
  \mathbf{B} &amp;= \left(\begin{array}{c}
    2 &amp; -4 \\
      -1 &amp; 2 \\
      -3 &amp; 1
  \end{array} \right)
\end{align} \]</span></p>
</div>
<div id="benders-algorithm-for-problems-with-extreme-rays" class="section level3" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> Benders Algorithm for Problems with Extreme Rays</h3>
<p><span class="math display">\[ \begin{align}
\min \quad &amp; 2 x_{1} + 6 x_{2} + 2 y_{1} + 3 y_{2} \\
  \text{s.t.} \quad &amp; - x_{1} + 2 x_{2} + 3 y_{1} - y_{2} \geq 5 \\
  &amp; x_{1} - 3 x_{2} + 2 y_{1} + 2 y_{2} \geq 4 \\
  &amp; x_{1}, x_{2} \geq 0 \\
  &amp; y_{1}, y_{2} \in \{0, 1, 2 \}
\end{align} \]</span>
which can be transformed into standard form:</p>
<p><span class="math display">\[ \begin{align}
\mathbf{c} &amp;= (2, 6)^T \\
  \mathbf{f} &amp;= (2, 3)^T \\
  \mathbf{b} &amp;= (5, 4)^T \\
  \mathbf{x} &amp;= (x_1, x_2)^T \\
  \mathbf{y} &amp;= (y_1, y_2)^T \\
  \mathbf{A} &amp;= \left(\begin{array}{c}
    -1 &amp; 2 \\
      1 &amp; -3
  \end{array} \right) \\
  \mathbf{B} &amp;= \left(\begin{array}{c}
    3 &amp; -1 \\
      2 &amp; 2
  \end{array} \right)
\end{align} \]</span></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="De.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="De-benders-l.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/edxu96/MatrixOptim.jl/edit/master/03-De.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
